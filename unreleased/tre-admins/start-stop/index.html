
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Azure TRE">
      
      
        <meta name="author" content="Microsoft">
      
      
        <link rel="canonical" href="https://microsoft.github.io/AzureTRE/unreleased/tre-admins/start-stop/">
      
      
        <link rel="prev" href="../../tre-templates/user-resources/export-reviewvm/">
      
      
        <link rel="next" href="../environment-variables/">
      
      
      <link rel="icon" href="../../assets/ms_icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Starting and Stopping Azure TRE Services - Azure TRE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "7gescazz1m");
</script>

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#startstop-azure-tre" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>
</script>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Azure TRE" class="md-header__button md-logo" aria-label="Azure TRE" data-md-component="logo">
      
  <img src="../../assets/ms_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Azure TRE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Starting and Stopping Azure TRE Services
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/AzureTre/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Azure TRE" class="md-nav__button md-logo" aria-label="Azure TRE" data-md-component="logo">
      
  <img src="../../assets/ms_icon.png" alt="logo">

    </a>
    Azure TRE
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/AzureTre/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/user-roles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Roles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/tre-resources-breakdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/airlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Airlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/cost-reporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cost Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/terms-definitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terms and Definitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure-tre-overview/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../setup-instructions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    QuickStart
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            QuickStart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Prerequisites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/deployment-repo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Deployment Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/ad-tenant-choices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. AD Tenant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/setup-auth-entities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Setup Auth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    5. Deployment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            5. Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_6_1" id="__nav_2_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Manual
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_1">
            <span class="md-nav__icon md-icon"></span>
            Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/manual-pre-deployment-steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre-deployment Steps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/manual-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CI/CD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            CI/CD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/cicd-pre-deployment-steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre-deployment Steps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/cicd-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/configuring-shared-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Configure Shared Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/ui-install-base-workspace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Install Base Workspace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/ui-install-ws-and-ur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Install Workspace Service and User Resource
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../using-tre/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Using the Azure TRE
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Using the Azure TRE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../using-tre/tre-for-research/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Using AzureTRE for Research
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Using AzureTRE for Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/tre-for-research/using-vms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Set up of a Virtual Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/tre-for-research/importing-exporting-data-airlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Importing/exporting data with Airlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/tre-for-research/review-airlock-request/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reviewing Airlock Requests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Templates and Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Templates and Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Workspaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Workspaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspaces/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspaces/unrestricted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unrestricted
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspaces/airlock-import-review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Airlock Import Review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Workspace Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Workspace Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/azure-ml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure ML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/gitea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitea
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/guacamole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guacamole
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/health_services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Health Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/databricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Databricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/ohdsi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OHDSI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/mysql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MySQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/azuresql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/workspace-services/openai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Open AI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Shared Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Shared Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/shared-services/gitea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitea (Source Mirror)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/shared-services/nexus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nexus (Package Mirror)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/shared-services/cyclecloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure CycleCloud (HPC Compute)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/shared-services/airlock-notifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Airlock Notifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            User Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/user-resources/guacamole-windows-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guacamole Windows VM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/user-resources/guacamole-linux-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guacamole Linux VM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/user-resources/import-reviewvm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Review VM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/user-resources/export-reviewvm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Export Review VM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Technical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Administration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Starting and Stopping Azure TRE Services
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Starting and Stopping Azure TRE Services
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#start-azure-tre" class="md-nav__link">
    <span class="md-ellipsis">
      Start Azure TRE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-azure-tre" class="md-nav__link">
    <span class="md-ellipsis">
      Stop Azure TRE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automating-stop" class="md-nav__link">
    <span class="md-ellipsis">
      Automating stop
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automating stop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop-runbook-script" class="md-nav__link">
    <span class="md-ellipsis">
      Stop Runbook Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automating-start" class="md-nav__link">
    <span class="md-ellipsis">
      Automating start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment-variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tear-down/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tear-down
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Authentication and Authorization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Authentication and Authorization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/auth-manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manual Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4_3" id="__nav_5_1_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Identities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            Identities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/application_admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application Admin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/test-account/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automation Test Account
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identities/workspace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workspaces
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registering-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Registering Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_6" >
        
          
          <label class="md-nav__link" for="__nav_5_1_6" id="__nav_5_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Install Resources via API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_6">
            <span class="md-nav__icon md-icon"></span>
            Install Resources via API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/installing-base-workspace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install Base Workspace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/installing-workspace-service-and-user-resource/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install Workspace Service and User Resource
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading-tre/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upgrading AzureTRE Version
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upgrading Resources Version
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-airlock-review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring Airlock Reviews
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../supported-clouds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Clouds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customer-managed-keys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customer Managed Keys
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-domain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Domain Name
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-firewall-force-tunneling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Firewall Force Tunneling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using-tre/local-development/local-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tre-developers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Contributing to AzureTRE
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            Contributing to AzureTRE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/resource-processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resource Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/end-to-end-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    End to End Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/letsencrypt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Letsencrypt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-instructions/workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/github-pr-bot-commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub PR Bot Commands
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developing Workspace Templates
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            Developing Workspace Templates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-workspace-authors/authoring-workspace-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authoring Workspace Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-workspace-authors/firewall-rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Firewall Rules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_3" id="__nav_5_2_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pipeline Templates
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Pipeline Templates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/pipeline-templates/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-templates/pipeline-templates/pipeline-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline Schema
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tre-developers/CLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AzureTRE CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../troubleshooting-faq/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Troubleshooting FAQ
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/debug-logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enabling DEBUG logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/api-logs-deployment-center/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API logs using deployment center
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/troubleshooting-sb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking the Service Bus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/app-insights-logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking Logs in Application Insights
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/troubleshooting-rp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting the Resource Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/airlock-troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting the Airlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/manually-editing-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manually edit resources in Cosmos DB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting-faq/cloud-init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting cloud-init
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#start-azure-tre" class="md-nav__link">
    <span class="md-ellipsis">
      Start Azure TRE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-azure-tre" class="md-nav__link">
    <span class="md-ellipsis">
      Stop Azure TRE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automating-stop" class="md-nav__link">
    <span class="md-ellipsis">
      Automating stop
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automating stop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop-runbook-script" class="md-nav__link">
    <span class="md-ellipsis">
      Stop Runbook Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automating-start" class="md-nav__link">
    <span class="md-ellipsis">
      Automating start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="startstop-azure-tre">Start/Stop Azure TRE</h1>
<p>Once you've provisioned an Azure TRE instance it will begin to incur running costs of the underlying Azure services.</p>
<p>Within evaluation or development, you may want to "pause" the TRE environment during out of office hours or weekends, to reduce costs without having to completely destroy the environment.  The following <code>make</code> targets provide a simple way to start and stop both the Azure Firewall and Azure Application Gateway instances, considerably reducing the Azure TRE instance running costs.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>After running <code>make all</code> underlying Azure TRE services are automatically started and billing will start.</p>
</div>
<h2 id="start-azure-tre">Start Azure TRE</h2>
<p>This will allocate the Azure Firewall settings with a public IP and start the Azure Application Gateway service, starting billing of both services.</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>tre-start
</code></pre></div>
<h2 id="stop-azure-tre">Stop Azure TRE</h2>
<p>This will deallocate the Azure Firewall public IP and stop the Azure Application Gateway service, stopping billing of both services.</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>tre-stop
</code></pre></div>
<h2 id="automating-stop">Automating <code>stop</code></h2>
<p>In certain situations, you might want to stop any TRE running on a schedule to reduce costs in a wider way.
We have this procedure setup in our development subscriptions where each night we stop all our environments after which each developer would need to <em>manually</em> start their TRE when they need it again.</p>
<h3 id="requirements">Requirements</h3>
<p>We use <a href="https://learn.microsoft.com/azure/automation/overview">Azure Automation</a> to run this procedure.</p>
<p>Be sure to create a runbook with PowerShell 7.1 or PowerShell 7.2 enabled and an identity with contributor permissions on the subscription. Note that the script below uses a system managed identity and if you use something different then you might need to update the authentication part.</p>
<p>If you create a new Automation account, you will have the required modules preinstalled.</p>
<p>Finally, schedule it to run when it makes sense for you.</p>
<h3 id="stop-runbook-script">Stop Runbook Script</h3>
<div class="highlight"><pre><span></span><code><span class="k">try</span> <span class="p">{</span>
  <span class="s2">&quot;Logging in to Azure...&quot;</span>
  <span class="nb">Connect-AzAccount</span> <span class="n">-Identity</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">{</span>
  <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
  <span class="k">throw</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
<span class="p">}</span>

<span class="nv">$azContext</span> <span class="p">=</span> <span class="nb">Get-AzContext</span>
<span class="nv">$azProfile</span> <span class="p">=</span> <span class="no">[Microsoft.Azure.Commands.Common.Authentication.Abstractions.AzureRmProfileProvider]</span><span class="p">::</span><span class="n">Instance</span><span class="p">.</span><span class="n">Profile</span>
<span class="nv">$profileClient</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Azure</span><span class="p">.</span><span class="n">Commands</span><span class="p">.</span><span class="n">ResourceManager</span><span class="p">.</span><span class="n">Common</span><span class="p">.</span><span class="n">RMProfileClient</span> <span class="n">-ArgumentList</span> <span class="p">(</span><span class="nv">$azProfile</span><span class="p">)</span>
<span class="nv">$token</span> <span class="p">=</span> <span class="nv">$profileClient</span><span class="p">.</span><span class="n">AcquireAccessToken</span><span class="p">(</span><span class="nv">$azContext</span><span class="p">.</span><span class="n">Subscription</span><span class="p">.</span><span class="n">TenantId</span><span class="p">)</span>

<span class="nv">$authHeader</span> <span class="p">=</span> <span class="p">@{</span>
  <span class="s1">&#39;Content-Type&#39;</span>  <span class="p">=</span> <span class="s1">&#39;application/json&#39;</span>
  <span class="s1">&#39;Authorization&#39;</span> <span class="p">=</span> <span class="s1">&#39;Bearer &#39;</span> <span class="p">+</span> <span class="nv">$token</span><span class="p">.</span><span class="n">AccessToken</span>
<span class="p">}</span>

<span class="c"># Get all resource groups that have the default Azure TRE project tag value</span>
<span class="nv">$ResourceGroups</span> <span class="p">=</span> <span class="nb">Get-AzResourceGroup</span> <span class="n">-Tag</span> <span class="p">@{</span><span class="s1">&#39;project&#39;</span> <span class="p">=</span> <span class="s1">&#39;Azure Trusted Research Environment&#39;</span> <span class="p">}</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$Group</span> <span class="k">in</span> <span class="nv">$ResourceGroups</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="o">-like</span> <span class="s1">&#39;*-ws-*&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Deal with the workspace resource groups separately (below)</span>
    <span class="k">continue</span>
  <span class="p">}</span>

  <span class="c"># Deallocate the Azure Firewall (expecting only one per TRE instance)</span>
  <span class="nv">$Firewall</span> <span class="p">=</span> <span class="nb">Get-AzFirewall</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$null</span> <span class="o">-ne</span> <span class="nv">$Firewall</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$Firewall</span><span class="p">.</span><span class="n">Deallocate</span><span class="p">()</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Deallocating Firewall &#39;</span><span class="p">$(</span><span class="nv">$Firewall</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
    <span class="nb">Set-AzFirewall</span> <span class="n">-AzureFirewall</span> <span class="nv">$Firewall</span>
  <span class="p">}</span>

  <span class="c"># Stop the Application Gateway(s)</span>
  <span class="c"># Multiple Application Gateways may exist if the certs shared service is installed</span>
  <span class="nv">$Gateways</span> <span class="p">=</span> <span class="nb">Get-AzApplicationGateway</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$Gateway</span> <span class="k">in</span> <span class="nv">$Gateways</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stopping Application Gateway &#39;</span><span class="p">$(</span><span class="nv">$Gateway</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
    <span class="nb">Stop-AzApplicationGateway</span> <span class="n">-ApplicationGateway</span> <span class="nv">$Gateway</span>
  <span class="p">}</span>

  <span class="c"># Stop the MySQL servers</span>
  <span class="nv">$MySQLServers</span> <span class="p">=</span> <span class="nb">Get-AzResource</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-ResourceType</span> <span class="s2">&quot;Microsoft.DBforMySQL/servers&quot;</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$Server</span> <span class="k">in</span> <span class="nv">$MySQLServers</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Invoke the REST API</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stopping MySQL &#39;</span><span class="p">$(</span><span class="nv">$Server</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
    <span class="nv">$restUri</span> <span class="p">=</span> <span class="s1">&#39;https://management.azure.com/subscriptions/&#39;</span> <span class="p">+</span> <span class="nv">$azContext</span><span class="p">.</span><span class="n">Subscription</span><span class="p">.</span><span class="n">Id</span> <span class="p">+</span> <span class="s1">&#39;/resourceGroups/&#39;</span> <span class="p">+</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="p">+</span> <span class="s1">&#39;/providers/Microsoft.DBForMySQL/servers/&#39;</span> <span class="p">+</span> <span class="nv">$Server</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s1">&#39;/stop?api-version=2020-01-01&#39;</span>
    <span class="nv">$response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$restUri</span> <span class="n">-Method</span> <span class="n">POST</span> <span class="n">-Headers</span> <span class="nv">$authHeader</span>
  <span class="p">}</span>

  <span class="c"># Deallocate all the virtual machine scale sets (resource processor)</span>
  <span class="nv">$VMSS</span> <span class="p">=</span> <span class="nb">Get-AzVMSS</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$VMSS</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stopping VMSS &#39;</span><span class="p">$(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
    <span class="nb">Stop-AzVmss</span> <span class="n">-ResourceGroupName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-VMScaleSetName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Force</span>
  <span class="p">}</span>

  <span class="c"># Deallocate all the VMs</span>
  <span class="nv">$VM</span> <span class="p">=</span> <span class="nb">Get-AzVM</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$VM</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stopping VM &#39;</span><span class="p">$(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
    <span class="nb">Stop-AzVm</span> <span class="n">-ResourceGroupName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-Name</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Force</span>
  <span class="p">}</span>

  <span class="c"># Process all the workspace resource groups for this TRE instance</span>
  <span class="nv">$WorkspaceResourceGroups</span> <span class="p">=</span> <span class="nb">Get-AzResourceGroup</span> <span class="n">-Name</span> <span class="s2">&quot;</span><span class="p">$(</span><span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span><span class="p">)</span><span class="s2">-ws-*&quot;</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$wsrg</span> <span class="k">in</span> <span class="nv">$WorkspaceResourceGroups</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Deallocate all the VMs</span>
    <span class="nv">$VM</span> <span class="p">=</span> <span class="nb">Get-AzVM</span> <span class="n">-ResourceGroupName</span> <span class="nv">$wsrg</span><span class="p">.</span><span class="n">ResourceGroupName</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$VM</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">Write-Output</span> <span class="s2">&quot;Stopping workspace VM &#39;</span><span class="p">$(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
      <span class="nb">Stop-AzVm</span> <span class="n">-ResourceGroupName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-Name</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Force</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="automating-start">Automating <code>start</code></h3>
<p>To restart the TRE core services (Firewall, Application Gateway(s), Virtual Machine Scale Sets, Virtual Machines, and MySQL), you can use <code>make tre-start</code>. Depending on your workflow, you might not be able to easily execute the <code>make</code> target. Alternatively, you can create a second Runbook and execute it manually. The PowerShell code to start TRE core services is below:</p>
<div class="highlight"><pre><span></span><code><span class="k">try</span> <span class="p">{</span>
    <span class="s2">&quot;Logging in to Azure...&quot;</span>
    <span class="nb">Connect-AzAccount</span> <span class="n">-Identity</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">{</span>
    <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
    <span class="k">throw</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
<span class="p">}</span>

<span class="nv">$azContext</span> <span class="p">=</span> <span class="nb">Get-AzContext</span>
<span class="nv">$azProfile</span> <span class="p">=</span> <span class="no">[Microsoft.Azure.Commands.Common.Authentication.Abstractions.AzureRmProfileProvider]</span><span class="p">::</span><span class="n">Instance</span><span class="p">.</span><span class="n">Profile</span>
<span class="nv">$profileClient</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Azure</span><span class="p">.</span><span class="n">Commands</span><span class="p">.</span><span class="n">ResourceManager</span><span class="p">.</span><span class="n">Common</span><span class="p">.</span><span class="n">RMProfileClient</span> <span class="n">-ArgumentList</span> <span class="p">(</span><span class="nv">$azProfile</span><span class="p">)</span>
<span class="nv">$token</span> <span class="p">=</span> <span class="nv">$profileClient</span><span class="p">.</span><span class="n">AcquireAccessToken</span><span class="p">(</span><span class="nv">$azContext</span><span class="p">.</span><span class="n">Subscription</span><span class="p">.</span><span class="n">TenantId</span><span class="p">)</span>

<span class="nv">$authHeader</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Content-Type&#39;</span>  <span class="p">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="s1">&#39;Authorization&#39;</span> <span class="p">=</span> <span class="s1">&#39;Bearer &#39;</span> <span class="p">+</span> <span class="nv">$token</span><span class="p">.</span><span class="n">AccessToken</span>
<span class="p">}</span>

<span class="c"># Get all resource groups that have the default Azure TRE project tag value</span>
<span class="nv">$ResourceGroups</span> <span class="p">=</span> <span class="nb">Get-AzResourceGroup</span> <span class="n">-Tag</span> <span class="p">@{</span><span class="s1">&#39;project&#39;</span> <span class="p">=</span> <span class="s1">&#39;Azure Trusted Research Environment&#39;</span> <span class="p">}</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$Group</span> <span class="k">in</span> <span class="nv">$ResourceGroups</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="o">-like</span> <span class="s1">&#39;*-ws-*&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Don&#39;t deal with the workspace resource groups</span>
        <span class="k">continue</span>
    <span class="p">}</span>

    <span class="nv">$azureTreId</span> <span class="p">=</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">Tags</span><span class="p">[</span><span class="s1">&#39;tre_id&#39;</span><span class="p">]</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Starting TRE core resources for &#39;$azureTreId&#39;&quot;</span>

    <span class="c"># Allocate the Azure Firewall (expecting only one per TRE instance)</span>
    <span class="nv">$Firewall</span> <span class="p">=</span> <span class="nb">Get-AzFirewall</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$null</span> <span class="o">-ne</span> <span class="nv">$Firewall</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Find the firewall&#39;s public IP and virtual network</span>
        <span class="nv">$pip</span> <span class="p">=</span> <span class="nb">Get-AzPublicIpAddress</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-Name</span> <span class="s2">&quot;pip-fw-$azureTreId&quot;</span>
        <span class="nv">$vnet</span> <span class="p">=</span> <span class="nb">Get-AzVirtualNetwork</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-Name</span> <span class="s2">&quot;vnet-$azureTreId&quot;</span>
        <span class="c"># Find the firewall&#39;s public management IP - note this will only be present for a firewall with a Basic SKU</span>
        <span class="nv">$mgmtPip</span> <span class="p">=</span> <span class="nb">Get-AzPublicIpAddress</span> <span class="n">-ResourceGroupName</span> <span class="s2">&quot;rg-$azureTreId&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;pip-fw-management-$azureTreId&quot;</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
        <span class="nv">$Firewall</span><span class="p">.</span><span class="n">Allocate</span><span class="p">(</span><span class="nv">$vnet</span><span class="p">,</span> <span class="nv">$pip</span><span class="p">,</span> <span class="nv">$mgmtPip</span><span class="p">)</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Allocating Firewall &#39;</span><span class="p">$(</span><span class="nv">$Firewall</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39; with public IP &#39;</span><span class="p">$(</span><span class="nv">$pip</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
        <span class="nb">Set-AzFirewall</span> <span class="n">-AzureFirewall</span> <span class="nv">$Firewall</span>
    <span class="p">}</span>

    <span class="c"># Start the Application Gateway(s)</span>
    <span class="c"># Multiple Application Gateways may exist if the certs shared service is installed</span>
    <span class="nv">$Gateways</span> <span class="p">=</span> <span class="nb">Get-AzApplicationGateway</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$Gateway</span> <span class="k">in</span> <span class="nv">$Gateways</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Starting Application Gateway &#39;</span><span class="p">$(</span><span class="nv">$Gateway</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
        <span class="nb">Start-AzApplicationGateway</span> <span class="n">-ApplicationGateway</span> <span class="nv">$Gateway</span>
    <span class="p">}</span>

    <span class="c"># Start the MySQL servers</span>
    <span class="nv">$MySQLServers</span> <span class="p">=</span> <span class="nb">Get-AzResource</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-ResourceType</span> <span class="s2">&quot;Microsoft.DBforMySQL/servers&quot;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$Server</span> <span class="k">in</span> <span class="nv">$MySQLServers</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Invoke the REST API</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Starting MySQL &#39;</span><span class="p">$(</span><span class="nv">$Server</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
        <span class="nv">$restUri</span> <span class="p">=</span> <span class="s1">&#39;https://management.azure.com/subscriptions/&#39;</span> <span class="p">+</span> <span class="nv">$azContext</span><span class="p">.</span><span class="n">Subscription</span><span class="p">.</span><span class="n">Id</span> <span class="p">+</span> <span class="s1">&#39;/resourceGroups/&#39;</span> <span class="p">+</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="p">+</span> <span class="s1">&#39;/providers/Microsoft.DBForMySQL/servers/&#39;</span> <span class="p">+</span> <span class="nv">$Server</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s1">&#39;/start?api-version=2020-01-01&#39;</span>
        <span class="nv">$response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$restUri</span> <span class="n">-Method</span> <span class="n">POST</span> <span class="n">-Headers</span> <span class="nv">$authHeader</span>
    <span class="p">}</span>

    <span class="c"># Allocate all the virtual machine scale sets (resource processor)</span>
    <span class="nv">$VMSS</span> <span class="p">=</span> <span class="nb">Get-AzVMSS</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$VMSS</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Starting VMSS &#39;</span><span class="p">$(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
        <span class="nb">Start-AzVmss</span> <span class="n">-ResourceGroupName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-VMScaleSetName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Name</span>
    <span class="p">}</span>

    <span class="c"># Start VMs</span>
    <span class="nv">$VM</span> <span class="p">=</span> <span class="nb">Get-AzVM</span> <span class="n">-ResourceGroupName</span> <span class="nv">$Group</span><span class="p">.</span><span class="n">ResourceGroupName</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$VM</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">Write-Output</span> <span class="s2">&quot;Starting VM &#39;</span><span class="p">$(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&#39;&quot;</span>
      <span class="nb">Start-AzVm</span> <span class="n">-ResourceGroupName</span> <span class="nv">$item</span><span class="p">.</span><span class="n">ResourceGroupName</span> <span class="n">-Name</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Name</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>